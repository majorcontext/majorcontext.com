---
import type { GetStaticPaths } from 'astro';
import { getCollection } from 'astro:content';
import DocsLayout from '../../../layouts/DocsLayout.astro';

export const getStaticPaths = (async () => {
  const docs = await getCollection('moat');

  return docs.map((doc) => {
    const parts = doc.id.split('/');
    const category = parts[0];
    const fileName = parts[1];
    const slug = fileName.replace(/^\d+-/, '').replace(/\.md$/, '');

    return {
      params: { category, slug },
      props: { doc },
    };
  });
}) satisfies GetStaticPaths;

const { doc } = Astro.props;
const { Content } = await doc.render();
const title = doc.data.title || doc.id;
---

<DocsLayout title={title} description={doc.data.description}>
  <Content />
</DocsLayout>
